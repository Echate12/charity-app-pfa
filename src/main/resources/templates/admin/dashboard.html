<!-- src/main/resources/templates/dashboard.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security6"
      lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CharityApp Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link th:href="@{/css/dashboard-dark-theme.css}" rel="stylesheet" />
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8f9fa; }
    .stat-card { background: #fff; border-radius: 8px; padding: 20px; margin-bottom: 20px; }
    .org-card { background: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 10px; text-align: center; }
    .progress { height: 10px; margin-top: 10px; }
    .sidebar { background-color: #fff; border-radius: 8px; padding: 20px; }
    .sidebar .nav-link.active { background-color: #1da1f2; color: #fff; border-radius: 5px; }
  </style>
</head>
<body>
<!-- Navbar -->
<div th:replace="fragments/navbar :: navbar"></div>

<div class="container my-4">
  <!-- Summary Cards -->
  <div class="row">
    <div class="col-md-3">
      <div class="stat-card text-center">
        <h5>Total Actions</h5>
        <h2 th:text="${totalActions}">0</h2>
      </div>
    </div>
    <div class="col-md-3">
      <div class="stat-card text-center">
        <h5>Total Donations</h5>
        <h2 th:text="${totalDonations}">0</h2>
      </div>
    </div>
    <div class="col-md-3">
      <div class="stat-card text-center">
        <h5>Total Organizations</h5>
        <h2 th:text="${totalOrganizations}">0</h2>
      </div>
    </div>
    <div class="col-md-3">
      <div class="stat-card text-center">
        <h5>Total Users</h5>
        <h2 th:text="${totalUsers}">0</h2>
      </div>
    </div>
  </div>

  <!-- Recent Donations -->
  <div class="card mb-4">
    <div class="card-header">
      <h5 class="mb-0">Recent Donations</h5>
    </div>
    <div class="card-body p-0">
      <table class="table mb-0">
        <thead>
        <tr>
          <th>ID</th>
          <th>Action ID</th>
          <th>Amount</th>
          <th>Date</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="d : ${recentDonations}">
          <td th:text="${d.id}">1</td>
          <td th:text="${d.charityActionId}">1</td>
          <td th:text="${d.amount}">$0</td>
          <td th:text="${#dates.format(d.donatedAt,'yyyy-MM-dd HH:mm')}">--</td>
        </tr>
        <tr th:if="${#lists.isEmpty(recentDonations)}">
          <td colspan="4" class="text-center text-muted">No recent donations.</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Organizations Grid -->
  <h5 class="mb-3">Organizations</h5>
  <div class="row g-3">
    <div class="col-md-3" th:each="org : ${organizations}">
      <div class="org-card">
        <img th:src="${org.logoUrl != null} ? ${org.logoUrl} : '/images/placeholder-org.png'"
             alt="Logo" class="img-fluid rounded mb-2" />
        <h6 th:text="${org.name}">Organization</h6>
        <div class="progress">
          <div class="progress-bar" role="progressbar"
               th:style="|width:${org.progressPercentage}%;|"
               th:text="${org.currentAmount} + ' / ' + ${org.goalAmount}">
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 text-center text-muted" th:if="${#lists.isEmpty(organizations)}">
      No organizations found.
    </div>
  </div>
</div>

<!-- Footer -->
<div th:replace="fragments/footer :: footer"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>